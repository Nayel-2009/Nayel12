<!doctype html>
<html lang="en">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Dashboard â€” StandUpTogether</title>
<link rel="stylesheet" href="style.css"></head>
<body>
<nav>
  <div class="brand">StandUpTogether</div>
  <div class="links">
    <a href="index.html">Home</a><a href="about.html">About</a><a href="timeline.html">Timeline</a><a href="lift.html">Lift Others Up</a><a href="stories.html">Stories</a><a href="positivity.html">Positivity Wall</a><a href="contact.html">Contact</a><a href="login.html">Login</a><a href="dashboard.html">Dashboard</a>
  </div>
  <div id="authContainer"></div>
</nav>

<div class="container">
  <div class="card">
  <h2>Share Your Story</h2>
  <input id="storyTitle" placeholder="Story title" class="input" />
  <textarea id="storyBody" placeholder="Write your story..." rows="5"></textarea>
  <button class="btn-game" onclick="submitStory()">Post Story</button>
</div>

<div class="card">
  <h2>Community Stories</h2>
  <div id="storiesList"></div>
</div>

  <div class="card">
    <h2>Your Dashboard</h2>
    <p>Welcome! Here you will find your quiz history, your submitted stories, and your saved quotes.</p>
    <div style="margin-top:12px">
      <button class="btn-game" onclick="ST.main.seedSampleData()">Seed Sample Data (admin only)</button>
    </div>
  </div>
</div>

<script type="module" src="main.js"></script>
<script>
  ST.main.renderAuthUI(document.getElementById('authContainer'));
  ST.main.initAuthState(()=>{});
</script>
</body>
  <script>
  async function submitStory() {
    const title = document.getElementById("storyTitle").value.trim();
    const body = document.getElementById("storyBody").value.trim();
    const user = ST.firebase.auth.currentUser;

    if (!user) {
      alert("You must be signed in to post a story.");
      return;
    }

    if (!title || !body) {
      alert("Please fill in both the title and story.");
      return;
    }

    await ST.main.addStory(title, body, user.displayName || user.email);
    document.getElementById("storyTitle").value = "";
    document.getElementById("storyBody").value = "";
  }

  function renderStories(stories) {
    const list = document.getElementById("storiesList");

    if (stories.length === 0) {
      list.innerHTML = "<p>No stories yet.</p>";
      return;
    }

    list.innerHTML = stories.map(s => `
      <div class="story-card">
        <h3>${s.title}</h3>
        <p>${s.body}</p>
        <small>By ${s.authorName || "Anonymous"} â€” ${s.createdAt?.toDate().toLocaleString() || ""}</small>
        <hr>
      </div>
    `).join("");
  }

  // ðŸ”¥ Live update from Firestore  
  ST.main.subscribeStories(renderStories);
</script>

</html>

